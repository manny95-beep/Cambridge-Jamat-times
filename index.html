<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Cambridge Mosque Jamat Times</title>
<style>
   body {
     font-family: Arial, sans-serif;
     background: #f5f7fa;
     color: #333;
     text-align: center;
     margin: 0;
     padding: 20px;
   }
   h1 {
     color: #006b5b;
   }
   table {
     width: 90%;
     margin: 20px auto;
     border-collapse: collapse;
     background: white;
     box-shadow: 0 0 8px rgba(0, 0, 0, 0.1);
   }
   th, td {
     padding: 12px;
     border: 1px solid #ddd;
   }
   th {
     background: #006b5b;
     color: white;
   }
   tr:nth-child(even) {
     background: #f9f9f9;
   }
   .error {
     color: red;
     margin-top: 20px;
   }
</style>
</head>
<body>
<h1>Cambridge Mosque Jamat Times</h1>
<p>Today's Date: <span id="todayDate"></span></p>
<table id="jamatTable">
<thead>
<tr>
<th>Mosque</th>
<th>Fajr</th>
<th>Dhuhr</th>
<th>Asr</th>
<th>Maghrib</th>
<th>Isha</th>
</tr>
</thead>
<tbody id="tableBody">
<tr><td colspan="6">Loading data...</td></tr>
</tbody>
</table>
<div class="error" id="errorMsg"></div>
<script>
 const sheetUrl = "https://docs.google.com/spreadsheets/d/1Vxvd7weNO-WDBZqEw9GbOxziPrq_0mq1ZkBL7eyuqLs/gviz/tq?tqx=out:csv";
 document.getElementById("todayDate").textContent = new Date().toLocaleDateString("en-GB");
 async function loadData() {
   try {
     const response = await fetch(sheetUrl);
     if (!response.ok) throw new Error("Failed to load Google Sheet");
     const csv = await response.text();
     const rows = csv.split("\n").map(r => r.split(",").map(c => c.trim()));
     // Get today's possible formats
     const today = new Date();
     const todayUK = today.toLocaleDateString("en-GB");
     const todayUS = today.toLocaleDateString("en-US");
     const todayShort = todayUK.replace(/^0/, '').replace(/\/0/, '/');
     const headers = rows[0];
     const dateCol = headers.indexOf("Date");
     const mosqueCol = headers.indexOf("Mosque");
     const fajrCol = headers.indexOf("Fajr");
     const dhuhrCol = headers.indexOf("Zuhr") !== -1 ? headers.indexOf("Zuhr") : headers.indexOf("Dhuhr");
     const asrCol = headers.indexOf("Asr");
     const maghribCol = headers.indexOf("Maghrib");
     const ishaCol = headers.indexOf("Isha");
     const tbody = document.getElementById("tableBody");
     tbody.innerHTML = "";
     // Filter today's rows
     const todayRows = rows.filter((r, i) => {
       if (i === 0) return false;
       const d = r[dateCol];
       return [todayUK, todayUS, todayShort].includes(d);
     });
     if (todayRows.length === 0) {
       tbody.innerHTML = `<tr><td colspan="6">No times found for ${todayUK}</td></tr>`;
       return;
     }
     todayRows.forEach(r => {
       const tr = document.createElement("tr");
       tr.innerHTML = `
<td>${r[mosqueCol]}</td>
<td>${r[fajrCol]}</td>
<td>${r[dhuhrCol]}</td>
<td>${r[asrCol]}</td>
<td>${r[maghribCol]}</td>
<td>${r[ishaCol]}</td>
       `;
       tbody.appendChild(tr);
     });
   } catch (err) {
     document.getElementById("errorMsg").textContent =
       "⚠️ Error loading data — please check your Google Sheet is public ('Anyone with the link can view').";
   }
 }
 loadData();
</script>
</body>
</html>


